---
title: "P8105_final_project"
author: "Hao Zheng (hz2770), Peilin Zhou (pz2281), Xiao Ma(xm2276), Yida Wang(yw3774), Ruilian Zhang (rz2570)"
date: "11/11/2021"
output: github_document
---

```{r setup, message = FALSE}
library(tidyverse)
library(rvest)
library(knitr)
theme_set(theme_minimal() + theme(legend.position = "bottom"))
options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)
scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```
Load the dataset NYPD shooting incident
```{r}
shooting = 
  read_csv("./data/NYPD_Shooting.csv") %>%
  janitor::clean_names()
```
check null
```{r}
shooting %>%
  summarise_all(~ sum(is.na(.)))
```
For col boro
```{r}
shooting %>% 
  mutate(boro = as.factor(boro)) 
```
For location_desc (maybe can change the name again )
```{r}
shooting %>%
  mutate(location_desc = replace_na(location_desc, "NONE")) %>%
  mutate(location_desc = as.factor(location_desc)) %>%
  mutate(location_desc = fct_relevel(location_desc, c("NONE", "MULTI DWELL - PUBLIC HOUS", "MULTI DWELL - APT BUILD", "PVT HOUSE", "GROCERY/BODEGA", "BAR/NIGHT CLUB", "HOSPITAL", "COMMERCIAL BLDG", "DEPT STORE", "GAS STATION", "HOTEL/MOTEL", "SMALL MERCHANT", "RESTAURANT/DINER", "CLOTHING BOUTIQUE", "FACTORY/WAREHOUSE", "SOCIAL CLUB/POLICY LOCATI"))) %>%
  mutate(location_desc = recode(location_desc, 
                                "NONE" = "none",
                                "MULTI DWELL - PUBLIC HOUS" = "public_house", 
                                "MULTI DWELL - APT BUILD" = "apt_building", 
                                "PVT HOUSE" = "pirvate_house", 
                                "GROCERY/BODEGA" = "grocery_bodega", 
                                "BAR/NIGHT CLUB" = "bar_club",
                                "HOSPITAL" = "hospital",
                                "COMMERCIAL BLDG" = "commercial",
                                "DEPT STORE" = "dept_store",
                                "GAS_STATION" = "gas_station",
                                "HOTEL/MOTEL" = "hotel",
                                "SMALL MERCHANT" = "merchant",
                                "RESTAURANT/DINER" = "restaurant",
                                "CLOTHING BOUTIQUE" = "clothing",
                                "FACTORY/WAREHOUSE" = "factory",
                                "SOCIAL CLUB/POLICY LOCATI" = "club"
                                ))
  
```

sort by date, arrange according to year and month
* compare the same month in different year
```{r}
shooting %>%
  separate(occur_date, into = c("month", "day", "year")) %>% 
  mutate(month = as.numeric(month)) %>% 
  arrange(year, month) %>% 
 # mutate(month = month.name[month]) %>% 
  mutate(year = as.character(year))
```
Try a plot by boro
```{r}
shooting %>%
  ggplot(aes(x = boro, y = precinct)) + 
  geom_point(alpha = .5) + 
  geom_smooth(method = "lm", se = FALSE) +
  labs(
    title = " ",
    x = "Boror",
    y = "Precint"
   ) 
```

